
@{
    ViewBag.Title = "Employee";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script type="text/javascript">
    var GetMasterCollectionUrl = "@Url.Action("GetMasterCollection", "Master")";
    var SetEmployeeUrl = "@Url.Action("SetEmployee", "Master")";
    var GetEmployeeUrl = "@Url.Action("GetEmployee", "Master")";
    var SetEmployeeExcelUploadUrl = "@Url.Action("EmployeeExcelUpload", "Master")";
    var SetEmployeeExcelUrl = "@Url.Action("SetEmployeeExcel", "Master")";
    var SetEmployeeExcelSubmitUrl = "@Url.Action("EmployeeExcelSubmit", "Master")";
    var GetdepartmentUrl = "@Url.Action("GetDepartment", "Master")";
    var GetDesignationUrl = "@Url.Action("GetDesignation", "Master")";
    var GetRoleAccessUrl = "@Url.Action("GetRole", "Master")";
    var GetEmployeeExcelUrl = "@Url.Action("GetEmployeeExcel", "Master")";
    var UploadExcelUrl = "@Url.Action("UploadExcel", "Master")";
    var GetDownloadUrl = "@Url.Action("DownloadExcelEmp", "Master")";
    var GetAccessUrl = "@Url.Action("GetPageAccess", "Admin")";
    var GetLogFileUrl = "@Url.Action("LogFile", "Admin")";
</script>

<div class="col-lg-12 pad-0" ng-controller="Employee_OperController">
    <div class="content-part" style="min-height:90vh;">
        <div class="row">
            <div class="col-lg-12 col-md-12">
                <h5 class="heading-h" style="margin-bottom: -10px;">Employee  Master</h5>
            </div>

            <div class="col-lg-12 col-md-12 fomr-div">
                <div class="responsive-tabs">
                    <!--Tab sec start-->
                    <h2>Employee Entry</h2>
                    <div class="">
                        <div class="row mar-0 fomr-div">
                            <div class="row mar-0 fomr-div">
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Employee Name</span><span style="color:red;padding:5px;">*</span>
                                    <input type="hidden" id="hdnEmployee" value="0" />
                                    <input type="text" ng-model="EmpName" id="txtEmployee" maxlength="100" ng-blur="LoadEmployeeDetails()" pattern=".{5,}" required title="Minimum 5 characters required" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>ICH Code</span><span style="color:red;padding:5px;">*</span>
                                    <input type="text" ng-model="ICHCode" id="txtICHCode" maxlength="10" pattern=".{5,}" required title="Minimum 5 characters required" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>SAP Code</span><span style="color:red;padding:5px;">*</span>
                                    <input type="text" ng-model="SAPCode" id="txtSAPCode" maxlength="10" pattern=".{5,}" required title="Minimum 5 characters required" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Department</span><span style="color:red;padding:5px;">*</span>
                                    <select id="ddlDepartment" ng-model="DptId">
                                        <option value="0">-- Select One --</option>
                                        <option ng-repeat="option in DepartmentSelect" value="{{option.DeptId}}">{{option.Dept}}</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row mar-0 fomr-div">
                            <div class="row mar-0 fomr-div">
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Designation</span><span style="color:red;padding:5px;">*</span>
                                    <select id="ddlDesignation" ng-model="DsgId">
                                        <option value="0">-- Select One --</option>
                                        <option ng-repeat="option in DesignationSelect" value="{{option.DsgId}}">{{option.Designation}}</option>
                                    </select>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Official Mobile</span><br>
                                    <input type="text" id="txtMobile" ng-model="OMobile" maxlength="10" onkeypress="return isNumber(event)" pattern=".{5,}" required title="Minimum 5 characters required" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Email</span><span style="color:red;padding:5px;">*</span>
                                    <input type="text" id="txtEmail" ng-model="OEmail" maxlength="50" pattern=".{5,}" required title="Minimum 5 characters required" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Role</span><span style="color:red;padding:5px;">*</span>
                                    <select id="ddlRole" ng-model="RleId">
                                        <option value="0">-- Select One --</option>
                                        <option ng-repeat="option in RoleSelect" value="{{option.RoleId}}">{{option.Role}}</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row mar-0 fomr-div">
                            <div class="row mar-0 fomr-div">
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Password</span><span style="color:red;padding:5px;">*</span>
                                    <input type="text" style="display: none;" />
                                    <input type="password" style="display: none;" />
                                    <input type="password" id="txtPassword" ng-model="Pwd" maxlength="50" autocomplete="Off" pattern=".{5,}" required title="Minimum 5 characters required" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <span>Function System</span>
                                    <select id="ddlFunctionlSystem" ng-model="FnSystem">
                                        <option value="0">-- Select One --</option>
                                        <option ng-repeat="option in FunctionalSystemArray" value="{{option.MCId}}">{{option.Name}}</option>
                                    </select>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <table style="margin-top: 15px;">
                                        <tr>
                                            <td>
                                                <input type="checkbox" ng-model="MultiSite" ng-true-value="'1'" ng-false-value="'0'" id="chkMultiSite" style="width: auto;" />
                                            </td>
                                            <td>
                                                <span style="margin-left: 10px;">Multi Site</span>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                    <input id="hfEmpId" ng-model="EmpId" type="hidden">
                                    <table style="margin-top: 15px;">
                                        <tr>
                                            <td>
                                                <input type="checkbox" ng-model="Active" ng-true-value="'1'" ng-false-value="'0'" checked="checked" id="chkActive" style="width: auto;" />
                                            </td>
                                            <td>
                                                <span style="margin-left: 10px;">Active</span>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div class="row mar-0 fomr-div">
                                <div class="row mar-0 fomr-div">
                                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                        <span>Working At</span><span style="color:red;padding:5px;">*</span>
                                        <select id="ddlWorkingAt" ng-model="WorkingAt">
                                            <option value="0">-- Select One --</option>
                                            <option value="1">Admin</option>
                                            <option value="2">Site</option>
                                        </select>
                                    </div>
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" style="margin-top: 15px;">
                                        <button style="background: #2c2c2c; color: #fff;margin-left:0px;" type="button" ng-click="SetEmployee()" class="btn btn-default SaveButton" ng-show="Add || UpdateOnly">{{btnName}}</button>
                                        <button type="button" ng-click="ClearEmployee()" class="btn btn-default ClearButton" style="margin-right:10px;">Clear</button>
                                        <button type="button" id="btnExcelDownLoad" ng-click="DownloadExcel()" class="btn btn-default ClearButton" ng-show="Download">Download</button>
                                    </div>
                                </div>
                                <div class="col-lg-12" style="margin: 10px 0px;">
                                    <div class="line"></div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="input-group col-xs-6 col-sm-6 col-lg-6 col-md-6" style="margin-bottom: 15px;">
                                        <div class="input-group-addon"><i class="fa fa-search"></i></div>
                                        <input type="text" class="form-control" placeholder="Search the employee" ng-model="searchEmployee" style="height: 35px;z-index: 1;">
                                    </div>
                                    <div style="max-width: 100%;max-height: 100%;overflow-x:scroll;">
                                        <table cellpadding="0" cellspacing="0" class="table table-hover table-responsive">
                                            <thead style="border-top: 1px solid #dddddd;border-bottom: 2px solid #dddddd;">
                                                <tr>
                                                    <th ng-click="sortType = 'Slno'; sortReverse = !sortReverse" style="width: 5%; min-width: 70px;text-align:center;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            SlNo
                                                            <span ng-show="sortType == 'Slno' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'Slno' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th width="10%" ng-show="Update || Delete" style="text-align:center;">
                                                        <span style="font-weight: bold; color: #6b6b6b; width: 8%; min-width: 80px;">Action</span>
                                                    </th>
                                                    <th ng-click="sortType = 'Employee'; sortReverse = !sortReverse" style="width: 15%; min-width: 150px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            Name
                                                            <span ng-show="sortType == 'Employee' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'Employee' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'ICHCode'; sortReverse = !sortReverse" style="width: 8%; min-width: 100px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            ICH Code
                                                            <span ng-show="sortType == 'ICHCode' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'ICHCode' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'SAPCode'; sortReverse = !sortReverse" style="width: 8%; min-width: 100px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            SAP Code
                                                            <span ng-show="sortType == 'SAPCode' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'SAPCode' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'Dept'; sortReverse = !sortReverse" style="width: 10%; min-width: 130px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            Department
                                                            <span ng-show="sortType == 'Dept' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'Dept' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'Desig'; sortReverse = !sortReverse" style="width: 10%; min-width: 130px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            Designation
                                                            <span ng-show="sortType == 'Desig' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'Desig' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'Email'; sortReverse = !sortReverse" style="width: 15%; min-width: 150px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            Email
                                                            <span ng-show="sortType == 'Email' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'Email' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'OMobile'; sortReverse = !sortReverse" style="width: 10%; min-width: 100px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            Mobile No
                                                            <span ng-show="sortType == 'OMobile' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'OMobile' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'Role'; sortReverse = !sortReverse" style="width: 8%; min-width: 100px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            Role
                                                            <span ng-show="sortType == 'Role' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'Role' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th ng-click="sortType = 'FuncSystem'; sortReverse = !sortReverse" style="width: 10%; min-width: 160px;cursor:pointer;">
                                                        <a href="#" style="text-decoration: none; color: #6b6b6b; font-weight: bold;">
                                                            Functional System
                                                            <span ng-show="sortType == 'FuncSystem' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'FuncSystem' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>
                                                    <th style="text-align:center;width: 8%; min-width: 100px;">
                                                        <span style="font-weight: bold; color: #6b6b6b; width: 5%; min-width: 80px;">Multi Site</span>
                                                    </th>
                                                    <th style="text-align:center;width: 8%; min-width: 100px;">
                                                        <span style="font-weight: bold; color: #6b6b6b; width: 5%; min-width: 50px;">Working At</span>
                                                    </th>
                                                    <th style="text-align:center;width: 8%; min-width: 100px;">
                                                        <span style="font-weight: bold; color: #6b6b6b; width: 5%; text-align: center; min-width: 80px;">Active</span>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody style="border-bottom: 1px solid #dddddd;">
                                                @*<tr ng-repeat="row in EmployeeGridArray | orderBy:sortType:sortReverse | filter:searchEmployee">*@
                                                <tr ng-repeat="row in EmployeeGridArray | orderBy:sortType:sortReverse | filter:searchEmployee    | pagination: curPage * pageSize | limitTo: pageSize">
                                                    <td scope="row" style="width: 5%; min-width: 60px;text-align:center;">{{row.Slno}}</td>
                                                    <td width="10%" ng-show="Update || Delete" style="text-align:center;">
                                                        <a style="cursor: pointer;" ng-click="DeleteEmployee(row.EmpId)" data-toggle="tooltip" data-placement="top" title="Delete" ng-show="Delete" onmouseover="$(this).tooltip('show')">
                                                            <img style="height: 20px;" src="~/Content/img/delete.png">
                                                        </a>
                                                        <a style="cursor: pointer;" ng-click="EditEmployee(row)" data-toggle="tooltip" data-placement="top" title="Edit" ng-show="Update" onmouseover="$(this).tooltip('show')">
                                                            <img style="height: 20px;" src="~/Content/img/edit.png">
                                                        </a>
                                                    </td>
                                                    <td width="15%">{{row.Employee}}</td>
                                                    <td width="8%">{{row.ICHCode}}</td>
                                                    <td width="8%">{{row.SAPCode}}</td>
                                                    <td width="10%">{{row.Dept}}</td>
                                                    <td width="10%">{{row.Desig}}</td>
                                                    <td width="15%">{{row.Email}}</td>
                                                    <td width="10%">{{row.OMobile}}</td>
                                                    <td width="8%">{{row.Role}}</td>
                                                    <td width="10%">{{row.FuncSystem}}</td>
                                                    <td style="text-align:center;" width="5%">
                                                        <input type="checkbox" disabled="disabled" ng-model="row.MultiSite" ng-true-value="'True'" ng-false-value="'False'" style="height: 15px;">
                                                    </td>
                                                    <td width="5%" style="text-align:center;">{{row.WorkingAt}}</td>
                                                    <td width="5%" style="text-align:center;">
                                                        <input type="checkbox" disabled="disabled" ng-model="row.Active" ng-true-value="'True'" ng-false-value="'False'" style="height: 15px;">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div ng-show="EmployeeGridArray.length > pageSize">
                                        <div class="col-lg-8 col-sm-12 col-xs-12 col-md-8" style="padding-left:0px;">
                                            <ul class="pagination-controle pagination">
                                                <li>
                                                    <button type="button" class="btn btn-primary" ng-disabled="curPage == 0"
                                                            ng-click="curPage=0" style="border-radius  : 0px;">
                                                        &lt;&lt; First
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button" class="btn btn-primary" ng-disabled="curPage == 0"
                                                            ng-click="curPage=curPage-1" style="border-radius  : 0px;">
                                                        &lt; Prev
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button" class="btn btn-primary" style="border-radius  : 0px;"
                                                            ng-disabled="curPage >= EmployeeGridArray.length/pageSize - 1"
                                                            ng-click="curPage = curPage+1">
                                                        Next &gt;
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button" class="btn btn-primary" style="border-radius  : 0px;"
                                                            ng-disabled="curPage >= EmployeeGridArray.length/pageSize - 1"
                                                            ng-click="LastPage()">
                                                        Last &gt;&gt;
                                                    </button>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="col-lg-4 col-sm-12 col-xs-12 col-md-4" style="padding:20px;padding-right:0px;">
                                            <span style="color: black;padding: 8px;background-color: #bbbbbb;" class="pull-right">Page {{curPage + 1}} of {{ numberOfPages() }}</span>
                                        </div>
                                    </div>
                                    @*<div ng-show="EmployeeGridArray.length!=0">
                                        <table style="float:right;">
                                            <tr>
                                                <td ng-show="searchEmployee==null || searchEmployee==''" style="padding-right: 10px;">Toal Records:{{EmployeeArrayLength}}</td>&nbsp;
                                                <td>
                                                    <nav>
                                                        <ul class="pagination">
                                                            <li ng-class="prevPageDisabled()">
                                                                <a href="" aria-label="Previous" ng-click="FirstPage()">
                                                                    <span aria-hidden="true" style="color:#337ab7;">First</span>
                                                                </a>
                                                            </li>
                                                            <li ng-class="prevPageDisabled()">
                                                                <a href="" aria-label="Previous" ng-click="prevPage()">
                                                                    <span aria-hidden="true" style="color:#337ab7;">Previous</span>
                                                                </a>
                                                            </li>
                                                            @*<li ng-repeat="n in range()" ng-class="{'active':n == currentPage}" ng-click="setPage(n)">
                                                                    <a href="" ng-if="n>=0 && (EmployeeGridArray |filter:searchEmployee).length>0" ng-bind="n+1"></a>
                                                                </li>
                                                            <li ng-class="nextPageDisabled()">
                                                                <a href="" aria-label="Next" ng-click="nextPage()">
                                                                    <span aria-hidden="true" style="color:#337ab7;">Next</span>
                                                                </a>
                                                            </li>
                                                            <li ng-class="nextPageDisabled()">
                                                                <a href="" aria-label="Next" ng-click="LastPage()">
                                                                    <span aria-hidden="true" style="color:#337ab7;">Last</span>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </nav>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>*@
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--Tab sec end-->
                    <!--Tab sec start-->
                    <h2>Excel Upload</h2>
                    <div class="tab-cnt">
                        <div style="margin: 20px 0px 0px 0px;" class="row mar-0 fomr-div">
                            <div style="margin-bottom: 10px;" class="row mar-0 fomr-div">
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>File No</span><br>
                                    <input type="text" id="txtFileNo" ng-model="EUNo" ng-keypress="FileNoChange($event)" maxlength="10" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>Date</span><br>
                                    <input type="text" disabled="disabled" ng-model="PostedOn" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtDate" />
                                </div>

                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>File Name</span><br>
                                    <form id="uploadform">
                                        <input type="file" id="fuEmployee" name="fuEmployee" class="clsfuEmployee" />
                                    </form>
                                    <input type="text" id="txtFileName" ng-model="EFilename" disabled="disabled" style="display: none; background-color: white; border: 1px solid #A9A9A9; padding: 4px;" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>Uploaded By</span><br>
                                    <input type="text" disabled="disabled" ng-model="UploadedBy" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtUploadedBy" />
                                </div>
                            </div>

                            <div style="margin-bottom: 15px;" class="row mar-0 fomr-div">

                                <div class="col-lg-6 col-md-6 col-sm-12 pad-0">

                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                        <span>Total Count</span><br>
                                        <input type="text" disabled="disabled" ng-model="Total" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtTotal" />
                                    </div>

                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                        <span>New</span><br>
                                        <input type="text" disabled="disabled" ng-model="New" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtNew" />
                                    </div>

                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                        <span>Modify</span><br>
                                        <input type="text" disabled="disabled" ng-model="Modified" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtModified" />
                                    </div>

                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                        <span>Invalid</span><br>
                                        <input type="text" disabled="disabled" ng-model="Invalid" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtInvalid" />
                                    </div>
                                </div>


                                <div class="col-lg-3 col-md-3 col-sm-6">
                                </div>

                                <div class="col-lg-3 col-md-3 col-sm-6" style="text-align: right;">
                                    <br />
                                    <a href="" id="aTemplateDownload" class="btn btn-default ClearButton" style="margin-left: -80px;" ng-show="Download">Template Download</a>
                                    <button ng-click="UploadEmployeeExcel()" id="btnUpload" style="background: #2c2c2c; color: #fff; margin-left: 15px;" type="button" class="btn btn-default SaveButton" ng-show="Add">Upload</button>
                                </div>
                            </div>

                            <div class="col-lg-12" style="margin: 10px 0px;">
                                <div class="line"></div>
                            </div>

                            <div class="col-lg-12">
                                <div class="grid-div">
                                    <table cellpadding="0" cellspacing="0" class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th style="width: 3%; min-width: 40px;color: #6b6b6b;">#</th>
                                                <th style="width: 12%; min-width: 150px;color: #6b6b6b;">Name</th>
                                                <th style="width: 8%; min-width: 100px;color: #6b6b6b;">ICH Code</th>
                                                <th style="width: 8%; min-width: 100px;color: #6b6b6b;">SAP Code</th>
                                                <th style="width: 9%; min-width: 130px;color: #6b6b6b;">Department</th>
                                                <th style="width: 9%; min-width: 130px;color: #6b6b6b;">Designation</th>
                                                <th style="width: 12%; min-width: 150px;color: #6b6b6b;">Email</th>
                                                <th style="width: 8%; min-width: 100px;color: #6b6b6b;">Mobile No</th>
                                                <th style="width: 8%; min-width: 100px;color: #6b6b6b;">Role</th>
                                                <th style="width: 8%; min-width: 80px;color: #6b6b6b;">Password</th>
                                                <th style="width: 8%; min-width: 50px;color: #6b6b6b;">MultiSite</th>
                                                <th style="width: 12%; min-width: 150px;color: #6b6b6b;">Func System</th>
                                                <th style="width: 8%; min-width: 50px;color: #6b6b6b;">Working At</th>
                                                <th class="ErrorMsg" style="width: 15%; color: #6b6b6b;min-width: 150px;">Error Msg</th>
                                                <th class="DelAction" style="width: 5%;color: #6b6b6b; min-width: 80px; display: none;">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="row in EmployeeExcelGridArray" on-finish-render="ngRepeatFinished" ng-class="{'Error': row.Color == 'Red', 'Modify': row.Color == 'Blue', 'New': row.Color == 'Green'}">
                                                <td scope="row">
                                                    {{$index + 1}}
                                                </td>
                                                <td>{{row.EName}}</td>
                                                <td>{{row.ICHCode}}</td>
                                                <td>{{row.SAPCode}}</td>
                                                <td>{{row.Department}}</td>
                                                <td>{{row.Designation}}</td>
                                                <td>{{row.OfficialEmailId}}</td>
                                                <td>{{row.OfficialMobileNo}}</td>
                                                <td>{{row.ERole}}</td>
                                                <td>{{row.Pwd}}</td>
                                                <td>{{row.MultiSite}}</td>
                                                <td>{{row.FuncSys}}</td>
                                                <td>{{row.WorkingAt}}</td>
                                                <td class="ErrorMsg">{{row.EMsg}}</td>
                                                <td class="DelAction" style="display: none;">
                                                    <a style="cursor: pointer;" ng-click="DeleteEmployeeExcel(row.RowId)" ng-show="Delete">
                                                        <img style="height: 20px;" src="~/Content/img/delete.png">
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="col-lg-12" style="margin: 25px 0px 0px 0px;">
                                <div class="line"></div>
                            </div>

                            <div class="row mar-0 fomr-div">
                                <div class="col-lg-12 col-md-12 col-sm-12">
                                    <span>Remarks</span><br>
                                    <textarea id="txtRemarks" ng-model="Remarks" rows="3"></textarea>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12" style="text-align: right;">
                                    <br />
                                    <button ng-click="SubmitEmployeeExcel()" id="btnSave" disabled="disabled" ng-show="Add" style="background: #2c2c2c; color: #fff;" type="button" class="btn btn-default SaveButton">Save</button>
                                    <button ng-click="PostEmployeeExcel()" id="btnPost" disabled="disabled" ng-show="Add" style="background: #2c2c2c; color: #fff;margin-left:0px;" type="button" class="btn btn-default SaveButton">Post</button>
                                    <button ng-click="ClearEmployeeExcel()" type="button" class="btn btn-default ClearButton">Clear</button>
                                </div>
                            </div>

                        </div>


                    </div>
                    <!--Tab sec end-->

                </div>
            </div>
            <div class="col-lg-12">
            </div>
            <div class="row mar-0">
                <div class="col-lg-12">
                    <div class="line"></div>
                </div>
            </div>
        </div>
    </div>
    <table id="tblExcelFormat" style="display:none;">
        <thead>
            <tr>
                <td>
                    SlNo
                </td>
                <td>
                    Name
                </td>
                <td>
                    ICH Code
                </td>
                <td>
                    SAP Code
                </td>
                <td>
                    Department
                </td>
                <td>
                    Designation
                </td>
                <td>
                    Email
                </td>
                <td>
                    Mobile No
                </td>
                <td>
                    Role
                </td>
                <td>
                    Functional System
                </td>
                <td>
                    Multi Site
                </td>
                <td>
                    Working At
                </td>
                <td>
                    Active
                </td>

            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="row in EmployeeGridArray">
                <th>{{row.Slno}}</th>
                <td>{{row.Employee}}</td>
                <td>{{row.ICHCode}}</td>
                <td>{{row.SAPCode}}</td>
                <td>{{row.Dept}}</td>
                <td>{{row.Desig}}</td>
                <td>{{row.Email}}</td>
                <td>{{row.OMobile}}</td>
                <td>{{row.Role}}</td>
                <td>{{row.FuncSystem}}</td>
                <td>{{row.MultiSite == 'True' ? Yes : No}}</td>
                <td>{{row.WorkingAt}}</td>
                <td>{{row.Active == 'True' ? Yes : No}}</td>
            </tr>
        </tbody>
    </table>
</div>

<script type="text/javascript">

    //$("#btnExcelDownLoad").click(function (e) {
    //    $("#tblExcelFormat").table2excel(
    //    {
    //        exclude: ".NoExl",
    //        name: "ExcelDoument"
    //    });
    //    e.preventDefault();
    //});

    $(".clsfuEmployee").on('change', function (e) {
        var iframe = $('<iframe name="postiframe" id="postiframe" style="display: none"></iframe>');
        $("body").append(iframe);
        var form = $('#uploadform');
        form.attr("action", "@Url.Action("UploadExcel", "Master")");
        form.attr("method", "post");
        form.attr("encoding", "multipart/form-data");
        form.attr("enctype", "multipart/form-data");
        form.attr("target", "postiframe");
        form.attr("file", $('#fuEmployee').val());
        form.submit();
    });

    @*$("#txtEmployee").keyup(function (e) {
        if (e.which != 13) {
            $("hdnEmployee").val("0");
        }

        if ($("#txtEmployee").val() == "")
            $("hdnEmployee").val("0");

        var CIRDetails = {
            txt: $("#txtEmployee").val(),
            refId: "",
            viewType: "6"
        };

        $("#txtEmployee").autocomplete({
            source: function (request, response) {

                $.ajax({
                    url: "@Url.Action("GetSearchDetails", "CIR")",
                    data: JSON.stringify(CIRDetails),
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        if (data.length != 0) {
                            response($.map(data, function (item) {

                                if (data.indexOf(item) === -1) {
                                    return { label: "No Results." }
                                } else {
                                    return {
                                        label: item.TextValue,
                                        val: item.Id
                                    }
                                }

                            }))
                        }
                        else {
                            return { label: "No Results." }
                        }
                    },
                    error: function (response) {

                    },
                    failure: function (respose) {

                    }
                });
            },
            minlength: 1,
            select: function (e, i) {
                $("#hdnEmployee").val(i.item.val);
                $("#txtEmployee").val(i.item.label);
            }
        });
    });*@

    $("#txtPassword").keypress(function (evt) {
        var keycode = evt.charCode || evt.keyCode;
        if (keycode == 32) {
            return false;
        }
    });

    $(function () {

        $('[data-toggle="tooltip"]').tooltip()
    })

    $(document).on("cut copy paste", "#txtMobile", function (e) {
        e.preventDefault();
    });

    fnTemplateDownload();

    function fnTemplateDownload() {
        var data = window.location.href;
        var Url = data.toLowerCase().replace('/master/employee', '');
        $("#aTemplateDownload").attr('href', (Url + "/Template/EmployeeTemplate.xlsx"));
    }

</script>
<script src="~/CIRScripts/MasterController.js" type="text/javascript"></script>
