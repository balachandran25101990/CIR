
@{
    ViewBag.Title = "Turbine";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using (Html.BeginForm())
{

    <script type="text/javascript">
        var SetTurbinePostUrl = "@Url.Action("SetTurbineVerUpdatePostExcel", "Master")";
        var SetTurbineExcelUploadUrl = "@Url.Action("TurbineVerUpdateExcelUpload", "Master")";
        var TurbineExcelSubmitUrl = "@Url.Action("TurbineVerUpdateExcelSubmit", "Master")";
        var SetTurbineVUExcelUrl = "@Url.Action("SetTurbineVerUpdateExcel", "Master")";
        var GetMasterCollectionUrl = "@Url.Action("GetMasterCollection", "Master")";
        var GetMasterCollectionSpecificationUrl = "@Url.Action("GetSubMasterCollection", "Master")";
        var GetTurbineUrl = "@Url.Action("GetTurbineVerUpdate", "Master")";
        var GetTurbineExcelUrl = "@Url.Action("GetTurbineVerUpdateExcel", "Master")";
        var UploadExcelUrl = "@Url.Action("UploadTurbineVerUpdateExcel", "Master")";
        var GetDownloadUrl = "@Url.Action("DownloadTurbineVerUpdateExcel", "Master")";
        var GetExcelDownloadUrl = "@Url.Action("GetTurbineVerUpdateExcelDown", "Master")";
        var GetAccessUrl = "@Url.Action("GetPageAccess", "Admin")";
        var GetLogFileUrl = "@Url.Action("LogFile", "Admin")";
        var LoadFileNameUrl = "@Url.Action("LoadFileName", "Master")";
        var GetStatusUrl = "@Url.Action("GetStatus", "Admin")";
        var GetTurbineVerUpdateLoadStatusUrl = "@Url.Action("GetTurbineVerUpdateLoadStatus", "Master")";
    </script>
}

<div class="col-lg-12 pad-0" ng-controller="TurbineVersionUpdate_OperController">
    <div class="content-part" style="min-height:90px;">
        <div class="row">
            <div class="col-lg-12 col-md-12" style="border-bottom: 1px #ccc dotted;padding-bottom:5px;">
                <div class="col-lg-6 col-md-6">
                    <h5 class="heading-h" style="margin-bottom: -10px; border-bottom:0px;">Turbine Version Update</h5>
                </div>

                <div class="col-lg-6 col-md-6" style="text-align:right;">

                    <input type="text" ng-model="Pending" style="color:red; text-align:right; border:0px; width:400px;" value="test" />
                </div>
            </div>
            <div class="col-lg-12 col-md-12 fomr-div">
                <div class="responsive-tabs">
                    <!--Tab sec start-->
                    <h2>Version Update</h2>
                    <div class="tab-cnt" ng-show="View">
                        <div style="margin: 20px 0px 0px 0px;" class="row mar-0 fomr-div">
                            <div style="margin-bottom: 10px;" class="row mar-0 fomr-div">
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>File No</span><br>
                                    <input type="text" id="txtFileNo" ng-model="TUNo" ng-keypress="FileNoChange($event)" maxlength="10" />
                                    <input type="hidden" ng-model="TUId" value="0" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>Date</span><br>
                                    <input type="text" disabled="disabled" ng-model="PostedOn" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtDate" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>File Name</span><br>
                                    <form id="uploadform">
                                        <input type="file" id="fuTurbine" name="fuTurbine" class="clsfuTurbine" />
                                    </form>
                                    <input type="text" id="txtFileName" ng-model="TFilename" disabled="disabled" style="display: none; background-color: white; border: 1px solid #A9A9A9; padding: 4px;" />
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>Uploaded By</span><br>
                                    <input type="text" disabled="disabled" ng-model="UploadedBy" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtUploadedBy" />
                                </div>
                            </div>
                            <div style="margin-bottom: 15px;" class="row mar-0 fomr-div">
                                <div class="col-lg-6 col-md-6 col-sm-12 pad-0">
                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                        <span>Total Count</span><br>
                                        <input type="text" disabled="disabled" ng-model="Total" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtTotal" />
                                    </div>
                                    @*<div class="col-lg-3 col-md-3 col-sm-6">
                                            <span>New</span><br>
                                            <input type="text" disabled="disabled" ng-model="New" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtNew" />
                                        </div>*@
                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                        <span>Modify</span><br>
                                        <input type="text" disabled="disabled" ng-model="Modified" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtModified" />
                                    </div>

                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                        <span>Invalid</span><br>
                                        <input type="text" disabled="disabled" ng-model="Invalid" style="background-color: white; border: 1px solid #A9A9A9; padding: 4px;" id="txtInvalid" />
                                    </div>
                                    <div class="col-lg-3 col-md-3 col-sm-6">
                                    </div>
                                </div>


                                <div class="col-lg-3 col-md-3 col-sm-6" style="text-align:right;">
                                    <br />
                                    @*<input type="text" style="border:none;  color:green ; font-size:16px;font-weight:bold;text-align:right;" ng-model="FileStatus" />*@

                                </div>

                                <div class="col-lg-3 col-md-3 col-sm-6" style="text-align: right;">
                                    <br />
                                    <a href="~/Template/TurbineVersionUpdate.xlsx" id="aTemplateDownload11" class="btn btn-default ClearButton" style="margin-left: -80px;">Download Template</a>
                                    <button ng-click="UploadTurbineVersUpdateExcel()" id="btnUpload" ng-show="Add" style="background: #2c2c2c; color: #fff; margin-left: 15px;" type="button" class="btn btn-default SaveButton">Upload</button>
                                </div>
                            </div>
                            <div class="col-lg-12" style="margin: 10px 0px;">
                                <div class="line"></div>
                            </div>
                            <div class="col-lg-12">
                                <div class="grid-div">
                                    <table cellpadding="0" cellspacing="0" class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th style="width: 2%; min-width: 40px;color: #6b6b6b;">S.No</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Turbine</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">SCADA Name</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Location</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Function Location</th>
                                                <th style="width: 8%; min-width: 150px;color: #6b6b6b;">Software version available<span style="color:red;padding:5px;">*</span></th>
                                                <th style="width: 8%; min-width: 150px;color: #6b6b6b;">CCU Firmware<span style="color:red;padding:5px;">*</span></th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Installation Date<span style="color:red;padding:5px;">*</span></th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Generator</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Blade</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Temperature Type </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Tower height </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Rotor Diameter </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">SiteName </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">State </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">CustomerGroup </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Customer </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">DOC </th>
                                                <th class="ErrorMsg" style="width: 10%;color: #6b6b6b; min-width: 150px;">Error Msg</th>
                                                <th class="DelAction" style="width: 4%;color: #6b6b6b; min-width: 80px; ">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="row in TurbineExcelGridArray" on-finish-render="ngRepeatFinished" ng-class="{'Error': row.Color == 'Red', 'Modify': row.Color == 'Blue', 'New': row.Color == 'Green'}">
                                                <td scope="row">
                                                    {{$index + 1}}
                                                    <input type="text" style="display:none ; border:0px;" value="{{row.RowId}}" />
                                                    <input type="text" style="display:none ; border:0px;" value="{{row.TbnId}}" />
                                                </td>
                                                <td>{{row.TurbineId}}</td>
                                                <td>{{row.SCADAName}}</td>
                                                <td>{{row.Location}}</td>
                                                <td>{{row.FunctionLocation}}</td>
                                                <td>
                                                    <select ng-model="row.SwVersion" ng-disabled="new_account">
                                                        <option value="0">-- Select One --</option>
                                                        <option ng-repeat="option in SWVersionSelect" ng-selected="row.SwVersion == option.Name" value="{{option.Name}}">{{option.Name}}</option>
                                                        @*<option  selected="selected" value="{{option.SwVersionId}}">{{row.SwVersion}}</option>*@
                                                    </select>

                                                    @*{{row.SwVersion}}*@
                                                </td>
                                                <td>
                                                    <select ng-model="row.hwVersion" ng-disabled="new_account">
                                                        <option value="0">-- Select One --</option>
                                                        <option ng-repeat="option in HWVersionSelect" ng-selected="row.hwVersion == option.Name" value="{{option.Name}}">{{option.Name}}</option>
                                                        @*<option ng-repeat="option in HWVersionSelect" selected="selected" value="{{option.MCId}}">{{row.hwVersion}}</option>*@
                                                    </select>
                                                    @*{{row.hwVersion}}*@
                                                </td>
                                                <td>
                                                    <input type="text" class="datepickerFormat" ng-disabled="new_account" ng-model="row.InstallationDate" value="{{row.InstallationDate}}" onkeypress="return isEvent(this)" />
                                                </td>
                                                <td>{{row.Generator}}</td>
                                                <td>{{row.Blade}}</td>
                                                <td>{{row.TemperatureType}}</td>
                                                <td>{{row.TowerHeight}}</td>
                                                <td>{{row.Rotordiameter}}</td>
                                                <td>{{row.SiteName}}</td>
                                                <td>{{row.State}}</td>
                                                <td>{{row.CustomerGroup}}</td>
                                                <td>{{row.Customer}}</td>
                                                <td>{{row.DOC}}</td>
                                                <td class="ErrorMsg">{{row.EMsg}}</td>
                                                <td class="DelAction" ng-show="Delete">
                                                    <a style="cursor: pointer;" ng-click="DeleteTurbineExcel(row.RowId)">
                                                        <img style="height: 20px;" src="~/Content/img/delete.png">
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col-lg-12" style="margin: 25px 0px 0px 0px;">
                                <div class="line"></div>
                            </div>
                            <div class="row mar-0 fomr-div">
                                <div class="col-lg-12 col-md-12 col-sm-12">
                                    <span>Remarks</span><span style="color:red;padding:5px;">*</span><br>
                                    <textarea id="txtRemarks" ng-model="Remarks" rows="3"></textarea>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <span id="spnStatus">Status</span><span id="spnMStatus" style="color:red;padding:5px;">*</span>
                                    <select id="ddlStatus" ng-model="Status" ng-change="LoadIsAutoAssignOrNot()">
                                        <option value="0">-- Select One --</option>
                                        <option value="1">Assigned</option>
                                    </select>

                                    <input type="text" id="txtStatus" ng-model="Tstatus" disabled="disabled" style="display: none; background-color: white; border: 1px solid #A9A9A9; padding: 4px;" />

                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <span id="spnAssign1">Assign To</span><span id="spnMAssign1" style="color:red;padding:5px;">*</span>
                                    <select id="ddlAssignedTo" ng-model="AssignTo">
                                        <option value="0" selected="selected">-- Select One --</option>
                                        <option ng-repeat="option in AssignToArray" value="{{option.StsId}}">{{option.Status}}</option>
                                    </select>
                                </div>

                                <div class="col-lg-6 col-md-6 col-sm-6" style="text-align: right;">
                                    <br />
                                    <button ng-click="SubmitTurbineVUExcel()" id="btnSave" ng-show="Add" disabled="disabled" style="background: #2c2c2c; color: #fff;" type="button" class="btn btn-default SaveButton">Save</button>
                                    <button ng-click="CancelTurbineVUExcel()" id="btnCancel" ng-show="Delete" disabled="disabled" style="background: #2c2c2c; color: #fff;" type="button" class="btn btn-default SaveButton">Cancel</button>
                                    <button ng-click="ClearTurbineExcel()" type="button" class="btn btn-default ClearButton">Clear</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--Tab sec end-->
                    <!--Tab sec start-->
                    <h2>Verify</h2>
                    <div class="tab-cnt" ng-show="Update">
                        <div style="margin: 20px 0px 0px 0px;" class="row mar-0 fomr-div">

                            <div style="margin-bottom: 10px;" class="row mar-0 fomr-div">
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>File Name</span><br>
                                    <select ng-model="PostFilename" ng-change="PostFileNameChange()">
                                        <option value="0">-- Select One --</option>
                                        <option ng-repeat="option in PostFilenameSelect" value="{{option.TUId}}">{{option.FileName}}</option>
                                    </select>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                </div>



                            </div>


                            <div class="col-lg-12" style="margin: 10px 0px;">
                                <div class="line"></div>
                            </div>

                            <div class="col-lg-12">
                                <div class="grid-div">
                                    <table cellpadding="0" cellspacing="0" class="table table-hover">
                                        <thead>
                                            <tr>

                                                <th style="width: 2%; min-width: 40px;color: #6b6b6b;">S.No</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Turbine</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">SCADA Name</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Location</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Function Location</th>
                                                <th style="width: 8%; min-width: 150px;color: #6b6b6b;">Software version available</th>
                                                <th style="width: 8%; min-width: 150px;color: #6b6b6b;">CCU Firmware</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Installation Date</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Generator</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Blade</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Temperature Type </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Tower height </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Rotor Diameter </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">SiteName </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">State </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">CustomerGroup </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Customer </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">DOC </th>
                                                <th class="ErrorMsg" style="width: 10%;color: #6b6b6b; min-width: 150px;">Error Msg</th>
                                                <th class="DelAction" style="width: 4%;color: #6b6b6b; min-width: 80px; ">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="row in TurbineExcelGridArray2" on-finish-render="ngRepeatFinished" ng-class="{'Error': row.Color == 'Red', 'Modify': row.Color == 'Blue', 'New': row.Color == 'Green'}">
                                                <td scope="row">
                                                    {{$index + 1}}

                                                    <input type="text" style="display:none ; border:0px;" value="{{row.RowId}}" />
                                                </td>
                                                <td>{{row.TurbineId}}</td>
                                                <td>{{row.SCADAName}}</td>
                                                <td>{{row.Location}}</td>
                                                <td>{{row.FunctionLocation}}</td>
                                                <td>{{row.SwVersion}}</td>
                                                <td>{{row.hwVersion}}</td>
                                                <td>{{row.InstallationDate}}</td>
                                                <td>{{row.Generator}}</td>
                                                <td>{{row.Blade}}</td>
                                                <td>{{row.TemperatureType}}</td>
                                                <td>{{row.TowerHeight}}</td>
                                                <td>{{row.Rotordiameter}}</td>
                                                <td>{{row.SiteName}}</td>
                                                <td>{{row.State}}</td>
                                                <td>{{row.CustomerGroup}}</td>
                                                <td>{{row.Customer}}</td>
                                                <td>{{row.DOC}}</td>
                                                @*<td class="ErrorMsg">{{row.EMsg}}</td>*@
                                                <td class="DelAction" style="display: none;" ng-show="Delete">
                                                    <a style="cursor: pointer;" ng-click="DeleteTurbineExcel2(row.RowId)">
                                                        <img style="height: 20px;" src="~/Content/img/delete.png">
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="col-lg-12" style="margin: 25px 0px 0px 0px;">
                                <div class="line"></div>
                            </div>

                            <div class="row mar-0 fomr-div">
                                <div class="col-lg-12 col-md-12 col-sm-12">
                                    <span>Remarks</span>
                                    <br>
                                    <textarea id="txtRemarks" ng-model="Remarks" rows="3"></textarea>
                                </div>

                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <span>Status</span><span style="color:red;padding:5px;">*</span>
                                    <select id="ddlStatus2" ng-model="Status2" ng-change="LoadIsAutoAssignOrNot2()">
                                        <option value="0">-- Select One --</option>
                                        <option value="3">Rejected</option>
                                        <option value="4">Assigned</option>
                                        @*<option ng-repeat="option in StatusArray2" value="{{option.StsId}}">{{option.Status}}</option>*@
                                    </select>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <span>Assign To</span><span style="color:red;padding:5px;">*</span>
                                    <select id="ddlAssignedTo2" ng-model="AssignTo2">
                                        <option value="0" selected="selected">-- Select One --</option>
                                        <option ng-repeat="option in AssignToArray2" value="{{option.StsId}}">{{option.Status}}</option>
                                    </select>
                                </div>
                                <div class="col-lg-6 col-md-6 col-sm-6" style="text-align: right;">
                                    <br />
                                    <button ng-click="Submit2TurbineVUExcel()" id="btnSave2" ng-show="Update" disabled="disabled" style="background: #2c2c2c; color: #fff;margin-left:0px;" type="button" class="btn btn-default SaveButton">Save</button>
                                    <button ng-click="Clear2TurbineExcel()" type="button" class="btn btn-default ClearButton">Clear</button>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!--Tab sec end-->
                    <!--Tab sec start-->
                    <h2>Post</h2>
                    <div class="tab-cnt" ng-show="Download">
                        <div style="margin: 20px 0px 0px 0px;" class="row mar-0 fomr-div">
                            <div style="margin-bottom: 10px;" class="row mar-0 fomr-div">
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                    <span>File Name</span><br>
                                    <select ng-model="PostFilename2" ng-change="PostFileNameChange2()">
                                        <option value="0" selected="selected">-- Select One --</option>
                                        <option ng-repeat="option in PostFilenameSelect2" value="{{option.TUId}}">{{option.FileName}}</option>
                                    </select>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">

                                </div>

                                <div class="col-lg-3 col-md-3 col-sm-6">

                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-6">
                                </div>



                            </div>


                            <div class="col-lg-12" style="margin: 10px 0px;">
                                <div class="line"></div>
                            </div>

                            <div class="col-lg-12">
                                <div class="grid-div">

                                    <table cellpadding="0" cellspacing="0" class="table table-hover">
                                        <thead>
                                            <tr>

                                                <th style="width: 2%; min-width: 40px;color: #6b6b6b;">S.No</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Turbine</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">SCADA Name</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Location</th>
                                                <th style="width: 6%; min-width: 100px;color: #6b6b6b;">Function Location</th>
                                                <th style="width: 8%; min-width: 150px;color: #6b6b6b;">Software version available</th>
                                                <th style="width: 8%; min-width: 150px;color: #6b6b6b;">CCU Firmware</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Installation Date</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Generator</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Blade</th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Temperature Type </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Tower height </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Rotor Diameter </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">SiteName </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">State </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">CustomerGroup </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">Customer </th>
                                                <th style="width: 5%; min-width: 80px;color: #6b6b6b;">DOC </th>
                                                <th class="ErrorMsg" style="width: 10%;color: #6b6b6b; min-width: 150px;">Error Msg</th>
                                                <th class="DelAction" style="width: 4%;color: #6b6b6b; min-width: 80px; ">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="row in TurbinePostExcelGridArray" on-finish-render="ngRepeatFinished" ng-class="{'Error': row.Color == 'Red', 'Modify': row.Color == 'Blue', 'New': row.Color == 'Green'}">
                                                <td scope="row">
                                                    {{$index + 1}}

                                                    <input type="text" style="display:none ; border:0px;" value="{{row.RowId}}" />
                                                </td>
                                                <td>{{row.TurbineId}}</td>
                                                <td>{{row.SCADAName}}</td>
                                                <td>{{row.Location}}</td>
                                                <td>{{row.FunctionLocation}}</td>
                                                <td>{{row.SwVersion}}</td>
                                                <td>{{row.hwVersion}}</td>
                                                <td>{{row.InstallationDate}}</td>
                                                <td>{{row.Generator}}</td>
                                                <td>{{row.Blade}}</td>
                                                <td>{{row.TemperatureType}}</td>
                                                <td>{{row.TowerHeight}}</td>
                                                <td>{{row.Rotordiameter}}</td>
                                                <td>{{row.SiteName}}</td>
                                                <td>{{row.State}}</td>
                                                <td>{{row.CustomerGroup}}</td>
                                                <td>{{row.Customer}}</td>
                                                <td>{{row.DOC}}</td>
                                                @*<td class="ErrorMsg">{{row.EMsg}}</td>*@
                                                <td class="DelAction" style="display: none;" ng-show="Delete">
                                                    <a style="cursor: pointer;" ng-click="DeleteTurbinePostExcel(row.RowId)">
                                                        <img style="height: 20px;" src="~/Content/img/delete.png">
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="col-lg-12" style="margin: 25px 0px 0px 0px;">
                                <div class="line"></div>
                            </div>

                            <div class="row mar-0 fomr-div">
                                <div class="col-lg-12 col-md-12 col-sm-12">
                                    <span>Remarks</span><br>
                                    <textarea id="txtRemarks" ng-model="Remarks" rows="3"></textarea>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <span>Status</span><span style="color:red;padding:5px;">*</span>
                                    <select id="ddlStatus3" ng-model="Status3" ng-change="LoadIsAutoAssignOrNot3()">
                                        <option value="0">-- Select One --</option>
                                        <option value="3">Rejected</option>
                                        <option value="9">Completed</option>
                                        @*<option ng-repeat="option in StatusArray2" value="{{option.StsId}}">{{option.Status}}</option>*@
                                    </select>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3">
                                    <span id="spnAssign">Assign To</span>
                                    <select id="ddlAssignedTo3" ng-model="AssignTo3">
                                        <option value="0" selected="selected">-- Select One --</option>
                                        <option ng-repeat="option in AssignToArray3" value="{{option.StsId}}">{{option.Status}}</option>
                                    </select>
                                </div>
                                <div class="col-lg-6 col-md-6 col-sm-6" style="text-align: right;">
                                    <br />
                                    <button ng-click="PostTurbineExcel()" id="btnPost" ng-show="Download" disabled="disabled" style="background: #2c2c2c; color: #fff;margin-left:0px;" type="button" class="btn btn-default SaveButton">Post</button>
                                    <button ng-click="ClearpostTurbineExcel()" type="button" class="btn btn-default ClearButton">Clear</button>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!--Tab sec end-->

                </div>
            </div>
            <div class="col-lg-12">
            </div>
            <div class="row mar-0">
                <div class="col-lg-12">
                    <div class="line"></div>
                </div>
            </div>
        </div>
    </div>
    <table style="display: none;" id="tblExcelFormat">
        <thead>
            <tr>
                <td>
                    SlNo
                </td>
                <td>
                    Turbine
                </td>
                <td>
                    Customer
                </td>
                <td>
                    DOC
                </td>
                <td>
                    Site
                </td>
                <td>
                    Functional Location

                </td>
                <td>
                    Capacity

                </td>
                <td>
                    Tower Height

                </td>
                <td>
                    Blade

                </td>
                <td>
                    Generator

                </td>
                <td>
                    Generator SlNo

                </td>
                <td>
                    Gear Box

                </td>
                <td>
                    Gear Box SlNo

                </td>
                <td>
                    Temperature

                </td>
                <td>
                    Dust

                </td>
                <td>
                    Corrosion

                </td>

            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="row in TurbineGridArray">
                <th>{{row.Slno}}</th>
                <td>{{row.TurbineId}}</td>
                <td>{{row.CustomerName}}</td>
                <td>{{row.DOC}}</td>
                <td>{{row.SiteName}}</td>
                <td>{{row.FnLoc}}</td>
                <td>{{row.Capacity}}</td>
                <td>{{row.TowerHeightName}}</td>
                <td>{{row.BladeName}}</td>
                <td>{{row.Generator}}</td>
                <td>{{row.GRSlno}}</td>
                <td>{{row.GearBox}}</td>
                <td>{{row.GBSlno}}</td>
                <td>{{row.Tempname}}</td>
                <td>{{row.DustName}}</td>
                <td>{{row.Corrosion}}</td>
            </tr>
        </tbody>
    </table>
</div>

<script type="text/javascript">

    //$("#btnExcelDownLoad").click(function (e) {
    //    $("#tblExcelFormat").table2excel(
    //    {
    //        exclude: ".NoExl",
    //        name: "ExcelDoument"
    //    });
    //    e.preventDefault();
    //});



    $(function () {
        $('body').on('focus', ".datepickerFormat", function () {
            $(this).datepicker();
        });
    });

    //function datePick(obj) {
    //    debugger;
    //    var rowid = obj.Id;
    //    $("#" + rowid).datepicker({
    //        format: 'dd/mm/yyyy',
    //        todayHighlight: true,
    //        autoclose: true,
    //        endDate: d,
    //        onSelect: function (dateText, inst) {
    //            setTimeout(function () {
    //                $(document).find('a.ui-state-highlight').removeClass('ui-state-highlight');
    //            }, 100);
    //        }
    //    });

    //}


    $(".clsfuTurbine").on('change', function (e) {
        var iframe = $('<iframe name="postiframe" id="postiframe" style="display: none"></iframe>');
        $("body").append(iframe);
        var form = $('#uploadform');
        form.attr("action", UploadExcelUrl);
        form.attr("method", "post");
        form.attr("encoding", "multipart/form-data");
        form.attr("enctype", "multipart/form-data");
        form.attr("target", "postiframe");
        form.attr("file", $('#fuTurbine').val());
        form.submit();
        //$("#txtFileName").val($('#fuTurbine').val());
    });

    $(function () {

        $('[data-toggle="tooltip"]').tooltip()
    })

    fnTemplateDownload();

    function fnTemplateDownload() {
        var data = window.location.href;
        var Url = data.toLowerCase().replace('/master/turbine', '');
        $("#aTemplateDownload").attr('href', (Url + "/Template/TurbineVersionUpdate.xlsx"));
    }

</script>
<script src="~/CIRScripts/MasterController.js" type="text/javascript"></script>

